$(document).ready(function() {
	var body = $("body");
	var mn2 = $(".main-navigation-container").clone();
	mn2.addClass("main-navigation-container-float");
	mn2.appendTo("#page");
	
	if ($("#contact-form form.sent").length) {
		$("#contact-form").addClass("sent");
		$("#contact-form").show();
	}
	
	if ($("#contact-form form.invalid").length) {
		$("#contact-form").addClass("invalid");
		$("#contact-form").show();
	}
	
	window.onscroll = function () {
		if (window.pageYOffset > 170 && body.width() > 767) {	
			/*mn2.css("top", window.pageYOffset + "px");*/
			mn2.show();
		} else {
			mn2.hide();
		}
		
	}
	
	$("#main-navigation-toggle").click(function(){
		var mn = $(".main-navigation");
		if (!mn.data("toggle")) {
			mn.slideUp();
			mn.data("toggle", 1);
			$("#main-navigation-toggle").text("↓ Показать меню");
		} else {
			mn.slideDown();
			mn.data("toggle", 0);
			$("#main-navigation-toggle").text("↑ Свернуть меню");
		}
	});
	
	$("#showcase-nav a").click(function(){
		$("#showcase-nav a").removeClass("current");
		$(this).addClass("current");
		$("#showcase .current").fadeOut("slow", function(){
			$("#showcase li").removeClass("current");
			$("#showcase li").eq($("#showcase-nav .current").data("slide")-1).addClass("current").hide().fadeIn();
		});
		return false;
	});
	
	
	
	//Выпадающее меню
	//$(window).resize(menuHover);
	menuHover();
	function menuHover(){
		//if($(window).width() > 767) 
		//{
			$(".main-navigation li").hover
			(
				function () {
					$(this).addClass("hover");
					clearTimeout($.data(this,'timer'));
					$('ul',this).stop(true,true).slideDown(0);
				}, function () {
					$(this).removeClass("hover");
					$.data(this,'timer', setTimeout($.proxy(function() {
					$('ul',this).stop(true,true).slideUp(150);
				}, this), 0));
				}
			);
		//} 
	}

	
	// Scroll to top
	var upperLimit = 100; 
	var scrollElem = $('a#scroll-to-top');
	var scrollSpeed = 500;
	scrollElem.hide();
	$(window).scroll(function () { 			
		var scrollTop = $(document).scrollTop();		
		if ( scrollTop > upperLimit ) {
			$(scrollElem).stop().fadeTo(300, 1); // fade back in			
		}else{		
			$(scrollElem).stop().fadeTo(300, 0); // fade out
		}
	});
	$(scrollElem).click(function(){ 
		$('html, body').animate({
			scrollTop:0
		}, scrollSpeed);
		return false; 
	});
	
	$("#fast-call, #fast-call-close").click(function(){
		$("#contact-form").fadeToggle();
		return false;
	});
});